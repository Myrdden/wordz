<!DOCTYPE html>
<html>
<head>
  <title>Thing</title>
</head>
<body>
<div id='root'></div>

<script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
<script>
const elem = React.createElement;

const Dictionary = props => {
  const populate = data => {
    return data.map((word, index) => {
      return elem(Word, {...word, key: index}, null);
    });
  }

  return elem('div', {},
    populate(props.data)
  );
};

const Word = props => {
  const [shown, setShown] = React.useState(false);
  const toggleChart = e => {
    e.preventDefault();
    setShown(!shown);
  };

  return elem('div', {className: 'word'},
    elem('h1', {}, props.header),
    elem('button', {onClick: e => toggleChart(e)}, 'clicc'),
    Chart({shown: shown})
  );
};

const Chart = props => {
  const isShown = () => {
    return (props.shown ? 'chart' : 'hidden');
  };

  const headers = ['', 'One', 'Two', 'Three', 'Four'];
  const rowHeaders = ['First', 'Second', 'Third', 'Fourth'];
  const data = [[1,2,3,4], [5,6,7,8], [9,10,11,12], [13,14,15,16]];

  return elem('div', {className: isShown()},
    elem('table', {},
      elem('tbody', {},
        elem('tr', {}, headers.map((header, i) => elem('th', {key: i}, header))),
        data.map((row, i) => {
          return elem('tr', {key: i},
            elem('th', {}, rowHeaders[i]),
            row.map((word, i) => elem('td', {key: i}, word)),
          )
        })
      )
    )
  );
};

const Input = ({setData}) => {
  const upload = e => {
    e.preventDefault();
    let reader = new FileReader();
    reader.onload = () => {
      setData(JSON.parse(reader.result));
    };
    reader.readAsText(e.target.files[0]);
  };

  return elem('div', {},
    elem('input', {type: 'file', name:'file', onChange: e => upload(e)}, null)
  );
};

const Output = ({data}) => {
  let blob = new Blob([JSON.stringify(data)], {type: 'text/plain;charset=utf-8'});
  return elem('a', {href: URL.createObjectURL(blob), download: 'hecc.txt'}, 'clicc');
}

const App = () => {
  const [data, setData] = React.useState(null);

  React.useEffect(() => {
    localStorage.setItem('data', JSON.stringify(data));
  }, [data]);

  if (data === null) {
    if (localStorage.getItem('data') !== 'null') {
      setData(JSON.parse(localStorage.getItem('data')));
    }
  }
  console.log(data);
  console.log(localStorage.getItem('data'));
  return elem('div', {},
    elem(Input, {setData: setData}, null),
    (data !== {} && data !== null) && elem('div', {},
      elem(Output, {data: data}, null),
      elem(Dictionary, {data: data}, null)
    )
  );
};

ReactDOM.render(elem(App), document.getElementById('root'));
</script>
<style>
  .hidden {display: none}
  .word {
    background: dimgrey;
    margin: 2rem;
  }

  .chart {

  }
</style>
</body>
</html>
